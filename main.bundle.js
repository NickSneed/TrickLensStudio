/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,n,t,o={171(e,n,t){t.d(n,{A:()=>m});var o=t(601),r=t.n(o),a=t(314),i=t.n(a),l=t(417),c=t.n(l),s=new URL(t(14),t.b),u=new URL(t(399),t.b),d=i()(r()),f=c()(s),p=c()(u);d.push([e.id,`:root {\n    /* main ui */\n    --c-copy: #171717;\n    --c-messagecopy: #4b4b4b;\n    --c-background: #cfcfcf;\n    --c-button: #aaa;\n    --c-canvasoutlinelight: color-mix(in srgb, var(--c-background) 60%, #fff);\n    --c-canvasoutlinedark: color-mix(in srgb, var(--c-background) 80%, #000);\n\n    /* modal */\n    --c-modal: #aaa;\n    --c-modalcopy: var(--c-copy);\n\n    /* toobar colors */\n    --c-green: #169e78;\n    --c-yellow: #f4c901;\n    --c-red: #c20000;\n    --c-blue: #2c51ac;\n\n    /* fonts */\n    --f-regular: 'DogicaPixel', sans-serif;\n    --f-bold: 'DogicaPixelBold', sans-serif;\n}\n\nbody[data-theme='dark'] {\n    --c-background: #1f1f1f;\n    --c-canvasoutlinelight: color-mix(in srgb, var(--c-background) 90%, #fff);\n    --c-canvasoutlinedark: color-mix(in srgb, var(--c-background) 50%, #000);\n}\n\n@font-face {\n    font-family: 'DogicaPixel';\n    src: url(${f}) format('woff2');\n    font-weight: 400;\n    font-style: normal;\n    font-display: swap;\n}\n\n@font-face {\n    font-family: 'DogicaPixelBold';\n    src: url(${p}) format('woff2');\n    font-weight: 800;\n    font-style: bold;\n    font-display: swap;\n}\n\nbody {\n    background-color: var(--c-background);\n    color: var(--c-copy);\n    font-family: sans-serif;\n    font-size: 16px;\n    font-weight: normal;\n    padding: 20px 10px;\n    font-family: var(--f-regular);\n    font-weight: 400;\n    font-style: normal;\n    letter-spacing: 0;\n}\n\ndiv {\n    box-sizing: border-box;\n}\n\nh1,\nh2,\nh3 {\n    font-family: var(--f-bold);\n}\n\nselect {\n    border: 2px solid var(--c-copy);\n    font-size: inherit;\n    font-family: var(--f-regular);\n    padding: 0.5em;\n    width: 100%;\n}\n\nbutton {\n    cursor: pointer;\n    font-family: 'DogicaPixel';\n    padding: 0;\n}\n\n.button {\n    background-color: var(--c-button);\n    border: none;\n    border-top: 4px solid color-mix(in srgb, var(--c-button) 10%, #000);\n    border-bottom: 4px solid color-mix(in srgb, var(--c-button) 10%, #000);\n    box-sizing: border-box;\n    box-shadow: inset 0 -4px 0 0 color-mix(in srgb, var(--c-button) 50%, #000);\n    color: var(--c-copy);\n    display: block;\n    font-size: inherit;\n    font-family: var(--f-regular);\n    height: 3.5em;\n    padding: 0.8em 0.8em 1.5em 0.8em;\n    position: relative;\n    width: 100%;\n}\n\n.button:after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -4px;\n    width: 100%;\n    height: 100%;\n    border-right: 4px solid color-mix(in srgb, var(--c-button) 10%, #000);\n    border-left: 4px solid color-mix(in srgb, var(--c-button) 10%, #000);\n}\n\n.button:before {\n    border: 4px solid color-mix(in srgb, var(--c-button) 30%, #fff);\n    border-top: none;\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n}\n\n@media (hover: hover) {\n    .button:hover {\n        background-color: color-mix(in srgb, var(--c-button) 60%, #fff);\n    }\n}\n\n.button:active {\n    transform: translatey(4px);\n}\n\n.closeButton,\n.closeButton:hover {\n    background: var(--c-modalcopy);\n    display: block;\n    border: none;\n    color: var(--c-modal);\n    font-family: var(--f-regular);\n    font-size: 1.4em;\n    height: 1.3em;\n    line-height: 1;\n    padding: 0;\n    width: 1.3em;\n}\n\n.colorgreen {\n    background-color: var(--c-green);\n}\n\n.coloryellow {\n    background-color: var(--c-yellow);\n}\n\n.colorred {\n    background-color: var(--c-red);\n    color: #fff;\n}\n\n.colorblue {\n    background-color: var(--c-blue);\n    color: #fff;\n}\n\n.fontBold {\n    font-family: var(--f-bold);\n}\n\nlabel {\n    cursor: pointer;\n    display: block;\n}\n\n.photoGrid {\n    padding: 0 0 19em;\n    display: grid;\n    gap: 10px;\n}\n\n.mainMessage {\n    color: var(--c-messagecopy);\n    font-family: var(--f-bold);\n    height: 70%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    left: 0;\n    position: fixed;\n    top: 0;\n    width: 100%;\n    z-index: 1;\n}\n@media (min-width: 1280px) {\n    body {\n        padding: 40px 20px;\n    }\n\n    .mainMessage {\n        height: 100%;\n    }\n\n    .photoGrid {\n        padding: 0 0 6em;\n        gap: 20px;\n    }\n}\n\n.pixel-checkbox {\n    display: block;\n    cursor: pointer;\n}\n\n.pixel-checkbox input {\n    position: absolute;\n    opacity: 0;\n    cursor: pointer;\n    height: 0;\n    width: 0;\n}\n\n.pixel-checkbox span {\n    background-color: #fff;\n    border: 2px solid var(--c-copy);\n    display: inline-block;\n    height: 1.5em;\n    margin-right: 0.5em;\n    position: relative;\n    vertical-align: middle;\n    width: 1.5em;\n}\n\n.pixel-checkbox input:checked ~ span:after {\n    content: '';\n    position: absolute;\n    left: 7px;\n    top: 2px;\n    width: 6px;\n    height: 12px;\n    border: solid var(--c-copy);\n    border-width: 0 4px 4px 0;\n    transform: rotate(45deg);\n}\n\n.pixel-checkbox input:disabled ~ span {\n    cursor: not-allowed;\n    background-color: var(--c-button);\n    border-color: var(--c-messagecopy);\n}\n\n.modal-open {\n    overflow: hidden;\n}\n`,""]);const m=d},713(e,n,t){t.d(n,{Ay:()=>f,Lt:()=>u,aw:()=>d,jW:()=>c,ne:()=>s,sH:()=>l});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".EditModal-module__editWrapper--Fe9C0 {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    margin: 0 auto;\n    max-width: 56em;\n}\n\n.EditModal-module__photo--aGGqS {\n    height: auto;\n    flex-grow: 1;\n    min-height: 0;\n    touch-action: none;\n}\n\n.EditModal-module__controls--zFLUl {\n    display: flex;\n    flex-direction: column;\n}\n\n.EditModal-module__select--iH2B_,\n.EditModal-module__slider--P4zeg {\n    margin: 0.5em 0 1em 0;\n    display: block;\n    width: 100%;\n}\n\n@media (min-width: 1280px) {\n    .EditModal-module__editWrapper--Fe9C0 {\n        flex-direction: row;\n    }\n\n    .EditModal-module__photo--aGGqS {\n        max-width: 40em;\n    }\n\n    .EditModal-module__controls--zFLUl {\n        flex-basis: 200px;\n        flex-shrink: 0;\n        margin-left: 2em;\n        padding-top: 0;\n    }\n}\n",""]);var l="EditModal-module__editWrapper--Fe9C0",c="EditModal-module__photo--aGGqS",s="EditModal-module__controls--zFLUl",u="EditModal-module__select--iH2B_",d="EditModal-module__slider--P4zeg";const f=i},963(e,n,t){t.d(n,{Ay:()=>s,Q5:()=>l,TF:()=>c});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".FileLoader-module__fileLoader--bKT0o {\n    position: relative;\n}\n\n.FileLoader-module__fileLoader--bKT0o input {\n    display: none;\n}\n\n.FileLoader-module__fileLoader--bKT0o button:not(.FileLoader-module__remove--eBBq8) {\n    padding-right: 50px !important;\n    text-align: left;\n}\n\n.FileLoader-module__fileLoader--bKT0o .FileLoader-module__remove--eBBq8 {\n    display: none;\n    position: absolute;\n    right: 0.4em;\n    top: 0.4em;\n}\n",""]);var l="FileLoader-module__fileLoader--bKT0o",c="FileLoader-module__remove--eBBq8";const s=i},197(e,n,t){t.d(n,{Ay:()=>p,EX:()=>s,V1:()=>f,VN:()=>d,a2:()=>u,rV:()=>l,yl:()=>c});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".Modal-module__modalwrapper--yCooO {\n    color: var(--c-modalcopy);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    height: 100vh;\n    left: 0;\n    padding: 1em;\n    position: fixed;\n    top: 0;\n    width: 100%;\n    z-index: 3;\n}\n\n.Modal-module__modal--Js7Xp {\n    background: var(--c-modal);\n    box-shadow: inset 0 0 0 8px var(--c-modalcopy);\n    border: 1.5em solid var(--c-modal);\n    position: relative;\n    margin: 0 auto;\n    padding: 3em 2em;\n    width: 100%;\n}\n\n.Modal-module__modal--Js7Xp h2 {\n    background: var(--c-modal);\n    display: inline-block;\n    font-size: 16px;\n    left: 1em;\n    padding: 0 0.5em;\n    position: absolute;\n    top: -1em;\n}\n\n.Modal-module__small--Foo3u .Modal-module__modal--Js7Xp {\n    max-width: 500px;\n}\n\n.Modal-module__full--F1aoh .Modal-module__modal--Js7Xp {\n    height: 100%;\n}\n\n.Modal-module__modal--Js7Xp .Modal-module__close--WjoyV {\n    box-shadow: 0 0 0 0.4em var(--c-modal);\n    position: absolute;\n    right: -0.5em;\n    top: -0.5em;\n    z-index: 4;\n}\n\n.Modal-module__modalscroll--pcjs2 {\n    overflow: auto;\n    max-height: calc(100vh - 11em);\n}\n",""]);var l="Modal-module__modalwrapper--yCooO",c="Modal-module__modal--Js7Xp",s="Modal-module__small--Foo3u",u="Modal-module__full--F1aoh",d="Modal-module__close--WjoyV",f="Modal-module__modalscroll--pcjs2";const p=i},158(e,n,t){t.d(n,{A:()=>c,P:()=>l});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".MontageToolbar-module__montagetoolbar--WRpWb {\n    bottom: 16.5em;\n    left: 0;\n    position: fixed;\n    width: 100%;\n}\n\nbutton {\n    border: none;\n    border-right: 2px solid #fff;\n    border-top: 2px solid #fff;\n}\n\n@media (min-width: 1280px) {\n    .MontageToolbar-module__montagetoolbar--WRpWb {\n        bottom: 5.7em;\n    }\n}\n",""]);var l="MontageToolbar-module__montagetoolbar--WRpWb";const c=i},294(e,n,t){t.d(n,{Ay:()=>f,O6:()=>c,P2:()=>l,Pf:()=>d,fp:()=>s,gB:()=>u});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".PaletteSelector-module__dropdownContainer--Xl2bC {\n    display: grid;\n    grid-template-columns: auto auto;\n}\n\n.PaletteSelector-module__swatchContainer--O4Dl3 {\n    border: 2px solid var(--c-modalcopy);\n    display: flex;\n    height: 20px;\n    margin: 0 auto 4px auto;\n    overflow: hidden;\n    vertical-align: middle;\n    width: 80px;\n}\n\n.PaletteSelector-module__swatchContainer--O4Dl3:hover,\n.PaletteSelector-module__swatchContainer--O4Dl3:active {\n    border-color: color-mix(in srgb, var(--c-modalcopy) 40%, #fff);\n}\n\n.PaletteSelector-module__swatchColorBlock--_G8v8 {\n    width: 25%;\n    height: 100%;\n}\n\n.PaletteSelector-module__radioInput--zcsqZ {\n    display: none;\n}\n\n.PaletteSelector-module__label--eged0 {\n    display: block;\n    margin: 4px;\n    cursor: pointer;\n    text-align: center;\n}\n\n@media (min-width: 700px) {\n    .PaletteSelector-module__dropdownContainer--Xl2bC {\n        display: grid;\n        grid-template-columns: auto auto auto auto;\n    }\n}\n\n@media (min-width: 900px) {\n    .PaletteSelector-module__dropdownContainer--Xl2bC {\n        display: grid;\n        grid-template-columns: auto auto auto auto auto;\n    }\n}\n\n@media (min-width: 1280px) {\n    .PaletteSelector-module__dropdownContainer--Xl2bC {\n        display: grid;\n        grid-template-columns: auto auto auto auto auto auto auto auto;\n    }\n}\n",""]);var l="PaletteSelector-module__dropdownContainer--Xl2bC",c="PaletteSelector-module__swatchContainer--O4Dl3",s="PaletteSelector-module__swatchColorBlock--_G8v8",u="PaletteSelector-module__radioInput--zcsqZ",d="PaletteSelector-module__label--eged0";const f=i},108(e,n,t){t.d(n,{Ay:()=>p,Ji:()=>c,KF:()=>d,Qd:()=>s,hs:()=>u,jW:()=>l,ne:()=>f});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".Photo-module__photo--sgkch {\n    padding: 0 0 20px;\n    text-align: center;\n}\n\n.Photo-module__canvas--Owi0R {\n    display: block;\n    margin: 0;\n}\n\n.Photo-module__canvasContainer--XlRf9 {\n    background: none;\n    border-style: solid;\n    border-width: 2px;\n    border-color: var(--c-canvasoutlinedark) var(--c-canvasoutlinelight) var(--c-canvasoutlinelight)\n        var(--c-canvasoutlinedark);\n    display: inline-block;\n    margin: 0 auto 10px;\n    position: relative;\n}\n\n.Photo-module__scale--h9s3N {\n    height: 100%;\n}\n\n.Photo-module__scale--h9s3N .Photo-module__canvas--Owi0R {\n    object-fit: contain;\n    padding: 0 !important;\n    height: 100% !important;\n    width: 100% !important;\n}\n\n.Photo-module__photo--sgkch .button {\n    margin: 0.5em;\n    max-width: 200px;\n    width: 100%;\n}\n.Photo-module__deleted--Hl4Th {\n    background: var(--c-red);\n    border: 2px solid #fff;\n    color: #fff;\n    padding: 0.2em;\n    position: absolute;\n    right: 0.4em;\n    top: 0.3em;\n}\n\n.Photo-module__controls--wXXsE .button,\n.Photo-module__controls--wXXsE label {\n    display: inline-block;\n}\n\n.Photo-module__controls--wXXsE label {\n    margin-left: 1.5em;\n}\n\n.Photo-module__controls--wXXsE label span {\n    margin: 0;\n}\n\n.scale1 .Photo-module__photo--sgkch .button span {\n    display: none;\n}\n\n.scale1 .Photo-module__photo--sgkch .button {\n    max-width: 7em;\n}\n\n.scale1 .Photo-module__controls--wXXsE label {\n    margin-left: 1em;\n}\n",""]);var l="Photo-module__photo--sgkch",c="Photo-module__canvas--Owi0R",s="Photo-module__canvasContainer--XlRf9",u="Photo-module__scale--h9s3N",d="Photo-module__deleted--Hl4Th",f="Photo-module__controls--wXXsE";const p=i},656(e,n,t){t.d(n,{Ay:()=>u,Tm:()=>c,W0:()=>l,pR:()=>s});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".SettingsMenu-module__settings--hiJiP label {\n    margin: 0 0 1em;\n}\n\n.SettingsMenu-module__settings--hiJiP select {\n    margin: 0.5em 0 0;\n}\n\n.SettingsMenu-module__qualityValue--ZfZTM {\n    display: inline-block;\n    margin: 1em;\n    text-align: right;\n    width: 3em;\n}\n\n.SettingsMenu-module__qualitySlider--VgbPX {\n    vertical-align: middle;\n    margin-left: 0;\n}\n",""]);var l="SettingsMenu-module__settings--hiJiP",c="SettingsMenu-module__qualityValue--ZfZTM",s="SettingsMenu-module__qualitySlider--VgbPX";const u=i},971(e,n,t){t.d(n,{Ay:()=>f,KE:()=>l,XJ:()=>d,jI:()=>c,oX:()=>s,wm:()=>u});var o=t(601),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([e.id,".ToolBar-module__toolbar--xnPbT {\n    bottom: 0;\n    box-sizing: border-box;\n    left: 0;\n    padding: 1em;\n    position: fixed;\n    width: 100%;\n    z-index: 2;\n}\n\n.ToolBar-module__toolbar--xnPbT:before,\n.ToolBar-module__toolbar--xnPbT:after {\n    opacity: 0.5;\n    content: '';\n    display: block;\n    height: 4px;\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin: 0 auto;\n    width: 100%;\n}\n\n.ToolBar-module__toolbar--xnPbT:before {\n    background: #fff;\n    top: 0;\n}\n\n.ToolBar-module__toolbar--xnPbT:after {\n    background: #000;\n    bottom: 0;\n}\n\n.ToolBar-module__toolbaritem--d0_Ol {\n    display: block;\n    margin: 0 0 0.5em;\n    width: 100%;\n}\n\n.ToolBar-module__settingsbutton--vzPEZ {\n    float: right;\n    margin: 0 10px;\n    width: auto;\n}\n\n.ToolBar-module__settingsbutton--vzPEZ button,\n.ToolBar-module__settingsbutton--vzPEZ button:hover {\n    background: none;\n    border: none;\n    color: inherit;\n    display: inline-block;\n    font-size: 40px;\n    height: 1em;\n    line-height: 1.1;\n    padding: 0;\n}\n\n.ToolBar-module__logo--QCJx0 {\n    float: left;\n    line-height: 2.5em;\n}\n\n.ToolBar-module__imageCount--vhhUG {\n    background: #333;\n    border: 2px solid #fff;\n    border-bottom: none;\n    border-right: none;\n    height: 2em;\n    right: 0;\n    color: #fff;\n    padding: 0.5em;\n    position: absolute;\n    top: -2em;\n}\n\n@media (min-width: 1280px) {\n    .ToolBar-module__toolbar--xnPbT .ToolBar-module__toolbaritem--d0_Ol {\n        display: block;\n        float: left;\n        margin: 0 1em 0 0;\n        max-width: 340px;\n        width: auto;\n    }\n\n    .ToolBar-module__logo--QCJx0 {\n        font-size: 24px;\n        float: right;\n        margin-right: 1em;\n    }\n\n    .ToolBar-module__settingsbutton--vzPEZ {\n        margin-top: 0.5em;\n    }\n}\n",""]);var l="ToolBar-module__toolbar--xnPbT",c="ToolBar-module__toolbaritem--d0_Ol",s="ToolBar-module__settingsbutton--vzPEZ",u="ToolBar-module__logo--QCJx0",d="ToolBar-module__imageCount--vhhUG";const f=i},14(e,n,t){e.exports=t.p+"assets/fonts/dogicapixel.840048d54c9574e0054b.woff2"},399(e,n,t){e.exports=t.p+"assets/fonts/dogicapixelbold.31468c516cb0d254273a.woff2"},43(e,n,t){var o=t(540),r=t(338),a=t(433),i=t(848);const l=function(){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.sv,{})})};var c=t(556),s=t(72),u=t.n(s),d=t(825),f=t.n(d),p=t(659),m=t.n(p),h=t(56),b=t.n(h),g=t(159),v=t.n(g),y=t(113),x=t.n(y),j=t(108),w={};w.styleTagTransform=x(),w.setAttributes=b(),w.insert=m().bind(null,"head"),w.domAPI=f(),w.insertStyleElement=v(),u()(j.Ay,w),j.Ay&&j.Ay.locals&&j.Ay.locals;var _=t(671);function S(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return O(s,"_invoke",function(t,o,r){var a,l,c,s=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,l=0,c=e,f.n=t,i}};function p(t,o){for(l=t,c=o,n=0;!d&&s&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,m=a[2];t>3?(r=m===o)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(l=0,f.v=o,f.n=a[1]):p<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,f.n=m,l=0))}if(r||t>1)return i;throw d=!0,o}return function(r,u,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),l=u,c=m;(n=l<2?e:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(r="next"),n=a[r]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,l<2&&(l=0)}else 1===l&&(n=a.return)&&n.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),l=1);a=e}else if((n=(d=f.n<0)?c:t.call(o,f))!==i)break}catch(n){a=e,l=1,c=n}finally{s=1}}return{value:n,done:d}}}(t,r,a),!0),s}var i={};function l(){}function c(){}function s(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(O(n={},o,function(){return this}),n),d=s.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,O(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,O(d,"constructor",s),O(s,"constructor",c),c.displayName="GeneratorFunction",O(s,r,"GeneratorFunction"),O(d),O(d,r,"Generator"),O(d,o,function(){return this}),O(d,"toString",function(){return"[object Generator]"}),(S=function(){return{w:a,m:f}})()}function O(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}O=function(e,n,t,o){function a(n,t){O(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},O(e,n,t,o)}function P(e,n,t,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(o,r)}function k(e){return T.apply(this,arguments)}function T(){var e;return e=S().m(function e(n){var t,o,r,a,i,l,c,s,u,d,f;return S().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,createImageBitmap(new Blob([n]));case 1:for(t=e.v,o=t.width,r=t.height,a=new OffscreenCanvas(o,r),(i=a.getContext("2d")).drawImage(t,0,0),l=i.getImageData(0,0,o,r),c=l.data,s=new Uint8Array(o*r),u=0;u<c.length;u+=4)d=c[u],f=c[u+3],s[u/4]=f<128?4:d>=200?0:d>=120?1:d>=40?2:3;return e.a(2,{width:o,height:r,data:s})}},e)}),T=function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){P(a,o,r,i,l,"next",e)}function l(e){P(a,o,r,i,l,"throw",e)}i(void 0)})},T.apply(this,arguments)}function C(e,n,t,o,r){var a=r||{},i=a.top,l=void 0===i?n?16:0:i,c=a.bottom,s=void 0===c?n?16:0:c,u=a.left,d=void 0===u?n?16:0:u,f=a.right,p=t+d+(void 0===f?n?16:0:f),m=o+l+s,h=new OffscreenCanvas(p,m),b=h.getContext("2d");return b.imageSmoothingEnabled=!1,b.drawImage(e,d,l,t,o),n&&b.drawImage(n,0,0,p,m),h}var A=function(e){return e?e.name.includes("wild")?{top:40,bottom:72,left:16,right:16}:{top:16,bottom:16,left:16,right:16}:{top:0,bottom:0,left:0,right:0}};function E(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return F(s,"_invoke",function(t,o,r){var a,l,c,s=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,l=0,c=e,f.n=t,i}};function p(t,o){for(l=t,c=o,n=0;!d&&s&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,m=a[2];t>3?(r=m===o)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(l=0,f.v=o,f.n=a[1]):p<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,f.n=m,l=0))}if(r||t>1)return i;throw d=!0,o}return function(r,u,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),l=u,c=m;(n=l<2?e:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(r="next"),n=a[r]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,l<2&&(l=0)}else 1===l&&(n=a.return)&&n.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),l=1);a=e}else if((n=(d=f.n<0)?c:t.call(o,f))!==i)break}catch(n){a=e,l=1,c=n}finally{s=1}}return{value:n,done:d}}}(t,r,a),!0),s}var i={};function l(){}function c(){}function s(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(F(n={},o,function(){return this}),n),d=s.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,F(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,F(d,"constructor",s),F(s,"constructor",c),c.displayName="GeneratorFunction",F(s,r,"GeneratorFunction"),F(d),F(d,r,"Generator"),F(d,o,function(){return this}),F(d,"toString",function(){return"[object Generator]"}),(E=function(){return{w:a,m:f}})()}function F(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}F=function(e,n,t,o){function a(n,t){F(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},F(e,n,t,o)}function D(e,n,t,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(o,r)}var I=function(e,n,t,r,a,i,l,c,s){var u=(0,o.useRef)(null),d=(0,o.useRef)(null),f=_.BG[r];return(0,o.useEffect)(function(){var o;e&&(o=E().m(function o(){var r,p,m,h,b,g,v,y,x,j,w,S,O,P,k,T,F,D;return E().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,r=e.width,p=e.height,m=e.photoData,h=n&&t?(0,_.Qk)(m,n.photoData,t.photoData,r,p,c,s):(0,_.GX)(m,f,l),o.n=1,createImageBitmap(new ImageData(h,r,p));case 1:if(b=o.v,g=null,!a){o.n=3;break}for(v=new Uint8Array(a.data.length),y=0;y<a.data.length;y++)v[y]=4===a.data[y]?0:a.data[y];for(x=(0,_.GX)(v,f,l),j=0;j<a.data.length;j++)4===a.data[j]&&(x[4*j+3]=0);return o.n=2,createImageBitmap(new ImageData(x,a.width,a.height));case 2:g=o.v;case 3:w=A(a),S=C(b,g,r,p,w),O=new OffscreenCanvas(10*S.width,10*S.height),(P=O.getContext("2d")).imageSmoothingEnabled=!1,P.drawImage(S,0,0,O.width,O.height),d.current=O,(k=u.current)&&(T=k.getContext("2d"),F=2*i,k.width=S.width*F,k.height=S.height*F,T.imageSmoothingEnabled=!1,T.drawImage(S,0,0,k.width,k.height)),o.n=5;break;case 4:o.p=4,D=o.v,console.log(D);case 5:return o.a(2)}},o,null,[[0,4]])}),function(){var e=this,n=arguments;return new Promise(function(t,r){var a=o.apply(e,n);function i(e){D(a,t,r,i,l,"next",e)}function l(e){D(a,t,r,i,l,"throw",e)}i(void 0)})})()},[e,f,a,i,10,l,n,t,c,s]),{displayCanvasRef:u,saveCanvasRef:d}},N=function(e){var n=e.onExport,t=e.onShare,o=e.onSelect,r=e.isSelected,a=e.isDisabled,l=e.imageIndex,c=e.format,s=void 0===c?"png":c;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("button",{className:"button",onClick:n,children:["Export",(0,i.jsxs)("span",{children:[" as ",s.toUpperCase()]})]}),t&&"undefined"!=typeof navigator&&navigator.share?(0,i.jsx)("button",{className:"button",onClick:t,children:"Share"}):null,o?(0,i.jsxs)("label",{className:"pixel-checkbox",children:[(0,i.jsx)("input",{type:"checkbox",checked:r,onChange:function(e){return o(l,e.target.checked)},disabled:a}),(0,i.jsx)("span",{})]}):null]})};N.propTypes={onExport:c.func.isRequired,onShare:c.func,onSelect:c.func,isSelected:c.bool,isDisabled:c.bool,imageIndex:c.number,format:c.string},N.defaultProps={onShare:null,onSelect:null,isSelected:!1,isDisabled:!1,imageIndex:-1,format:"png"};const R=N;function M(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return B(s,"_invoke",function(t,o,r){var a,l,c,s=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,l=0,c=e,f.n=t,i}};function p(t,o){for(l=t,c=o,n=0;!d&&s&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,m=a[2];t>3?(r=m===o)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(l=0,f.v=o,f.n=a[1]):p<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,f.n=m,l=0))}if(r||t>1)return i;throw d=!0,o}return function(r,u,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),l=u,c=m;(n=l<2?e:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(r="next"),n=a[r]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,l<2&&(l=0)}else 1===l&&(n=a.return)&&n.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),l=1);a=e}else if((n=(d=f.n<0)?c:t.call(o,f))!==i)break}catch(n){a=e,l=1,c=n}finally{s=1}}return{value:n,done:d}}}(t,r,a),!0),s}var i={};function l(){}function c(){}function s(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(B(n={},o,function(){return this}),n),d=s.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,B(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,B(d,"constructor",s),B(s,"constructor",c),c.displayName="GeneratorFunction",B(s,r,"GeneratorFunction"),B(d),B(d,r,"Generator"),B(d,o,function(){return this}),B(d,"toString",function(){return"[object Generator]"}),(M=function(){return{w:a,m:f}})()}function B(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}B=function(e,n,t,o){function a(n,t){B(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},B(e,n,t,o)}function G(e,n,t,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(o,r)}function L(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){G(a,o,r,i,l,"next",e)}function l(e){G(a,o,r,i,l,"throw",e)}i(void 0)})}}var q=function(e){return e?"-"+e.toLowerCase().replace(/\s/g,"-"):""};function z(e){var n=e.image,t=e.imageG,r=e.imageB,a=e.paletteId,l=e.frame,c=e.scaleFactor,s=e.showDeletedFlag,u=e.isScale,d=e.onClick,f=e.onSelect,p=e.isSelected,m=e.isDisabled,h=e.drawHandlers,b=e.paletteOrder,g=e.username,v=e.exportFormat,y=e.exportQuality,x=e.showShareButton,w=void 0!==x&&x,_=e.rgbBrightness,S=e.rgbContrast,O=I(n,t,r,a,l,c,b,_,S),P=O.displayCanvasRef,k=function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"png",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.9;return{handleExport:(0,o.useCallback)(L(M().m(function o(){var i,l,c,s,u;return M().w(function(o){for(;;)switch(o.n){case 0:if(i=e.current){o.n=1;break}return console.error("Save canvas not ready for export."),o.a(2);case 1:return l="jpg"===r?"image/jpeg":"image/png",c="jpg"===r?"jpg":"png",o.n=2,i.convertToBlob({type:l,quality:a});case 2:s=o.v,(u=document.createElement("a")).download="gbcam".concat(q(n),"-").concat(t,"-").concat(Date.now(),".").concat(c),u.href=URL.createObjectURL(s),u.click(),URL.revokeObjectURL(u.href);case 3:return o.a(2)}},o)})),[e,n,t,r,a]),handleShare:(0,o.useCallback)(L(M().m(function o(){var i,l,c,s,u,d,f;return M().w(function(o){for(;;)switch(o.p=o.n){case 0:if(i=e.current){o.n=1;break}return o.a(2);case 1:return o.p=1,l="jpg"===r?"image/jpeg":"image/png",c="jpg"===r?"jpg":"png",o.n=2,i.convertToBlob({type:l,quality:a});case 2:if(s=o.v,u="gbcam".concat(q(n),"-").concat(t,"-").concat(Date.now(),".").concat(c),d=new File([s],u,{type:l}),!navigator.canShare||!navigator.canShare({files:[d]})){o.n=3;break}return o.n=3,navigator.share({files:[d]});case 3:o.n=5;break;case 4:o.p=4,f=o.v,console.error("Error sharing:",f);case 5:return o.a(2)}},o,null,[[1,4]])})),[e,n,t,r,a])}}(O.saveCanvasRef,g,a,v,y),T=k.handleExport,C=k.handleShare,A=c,E=l?160:128,F=l&&l.name.includes("wild"),D=l?"0":16*A+"px",N=E*A,B=(l?F?224:144:112)*A;if(!n)return null;var G=h||{},z=G.onDrawStart,X=G.onDrawMove,Q=G.onDrawEnd,U=G.onMouseLeave,J=(0,i.jsxs)(i.Fragment,{children:[n.isDeleted&&s?(0,i.jsx)("div",{className:j.KF,children:"d"}):null,(0,i.jsx)("canvas",{className:j.Ji,width:N,height:B,style:{padding:D,width:N+"px",height:B+"px"},ref:P,onMouseDown:z,onMouseMove:X,onMouseUp:Q,onMouseLeave:U,onTouchStart:z,onTouchMove:X,onTouchEnd:Q})]});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"".concat(j.jW," ").concat(u?j.hs:""),children:[d?(0,i.jsx)("button",{className:j.Qd,onClick:d,children:J}):(0,i.jsx)("div",{className:j.Qd,children:J}),(0,i.jsx)("div",{className:j.ne,children:(0,i.jsx)(R,{onExport:T,onShare:w?C:null,onSelect:f,isSelected:p,isDisabled:m,imageIndex:null==n?void 0:n.index,format:v})})]})})}z.propTypes={image:c.object,imageG:c.object,imageB:c.object,paletteId:c.string,frame:c.object,scaleFactor:c.number,showDeletedFlag:c.bool,isScale:c.bool,onClick:c.func,onSelect:c.func,isSelected:c.bool,isDisabled:c.bool,drawHandlers:c.shape({onDrawStart:c.func,onDrawMove:c.func,onDrawEnd:c.func,onMouseLeave:c.func}),paletteOrder:c.string,username:c.string,exportFormat:c.string,exportQuality:c.number,showShareButton:c.bool,rgbBrightness:c.number,rgbContrast:c.number};const X=z;var Q=t(294),U={};U.styleTagTransform=x(),U.setAttributes=b(),U.insert=m().bind(null,"head"),U.domAPI=f(),U.insertStyleElement=v(),u()(Q.Ay,U),Q.Ay&&Q.Ay.locals&&Q.Ay.locals;var J=t(197),W={};W.styleTagTransform=x(),W.setAttributes=b(),W.insert=m().bind(null,"head"),W.domAPI=f(),W.insertStyleElement=v(),u()(J.Ay,W),J.Ay&&J.Ay.locals&&J.Ay.locals;var V=function(e){var n=e.isOpen,t=e.setIsOpen,r=e.title,a=e.children,l=e.type;return(0,o.useEffect)(function(){return n?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),function(){document.body.classList.remove("modal-open")}},[n]),(0,i.jsx)("div",{className:"".concat(J.rV," ").concat("small"===l?J.EX:""," ").concat("full"===l?J.a2:""),onClick:function(){return t(!1)},style:{display:n?"flex":"none"},children:(0,i.jsxs)("div",{className:J.yl,onClick:function(e){return e.stopPropagation()},children:[(0,i.jsx)("button",{className:"closeButton ".concat(J.VN),onClick:function(){return t(!n)},children:"x"}),(0,i.jsx)("h2",{children:r}),(0,i.jsx)("div",{className:J.V1,children:a})]})})};V.propTypes={isOpen:c.bool.isRequired,setIsOpen:c.func.isRequired,title:c.string.isRequired,children:c.node,type:c.string};const H=V;function K(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}var Z=function(e){var n,t,r=e.selectedPalette,a=e.onPaletteChange,l=(n=(0,o.useState)(!1),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,a,i,l=[],c=!0,s=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=a.call(t)).done)&&(l.push(o.value),l.length!==n);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(n,t)||function(e,n){if(e){if("string"==typeof e)return K(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?K(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],s=l[1];return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:function(){return s(!c)},className:"button",children:"Palette: ".concat(r)}),(0,i.jsx)(H,{isOpen:c,setIsOpen:s,title:"Palettes",allowScroll:!0,zindex:8,children:(0,i.jsx)("div",{className:Q.P2,children:Object.keys(_.BG).map(function(e){var n=_.BG[e].colors,t=r===e;return(0,i.jsxs)("label",{className:Q.Pf,children:[(0,i.jsx)("input",{type:"radio",name:"palette",value:e,checked:t,onChange:function(e){return function(e){a(e),s(!1)}(e.target.value)},className:Q.gB}),(0,i.jsx)("span",{className:Q.O6,style:t?{borderColor:"color-mix(in srgb, var(--c-modalcopy) 20%, #fff)"}:null,children:n.map(function(e,n){return(0,i.jsx)("span",{className:Q.fp,style:{backgroundColor:"rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")")}},n)})}),e]},e)})})})]})})};Z.propTypes={selectedPalette:c.string.isRequired,onPaletteChange:c.func.isRequired};const $=Z;var Y=t(963),ee={};ee.styleTagTransform=x(),ee.setAttributes=b(),ee.insert=m().bind(null,"head"),ee.domAPI=f(),ee.insertStyleElement=v(),u()(Y.Ay,ee),Y.Ay&&Y.Ay.locals&&Y.Ay.locals;var ne=(0,o.forwardRef)(function(e,n){var t=e.text,r=e.onChange,a=e.onRemove,l=e.showRemove,c=e.accept,s=new FileReader,u=(0,o.useRef)(null),d=n||u;return(0,i.jsxs)("div",{className:Y.Q5,children:[(0,i.jsx)("input",{ref:d,type:"file",id:"images",accept:c,multiple:!0,onChange:function(e){var n=e.target.files[0];n&&(s.onload=function(){r({data:s.result,name:n.name})},s.readAsArrayBuffer(n))}}),(0,i.jsx)("button",{className:"button",onClick:function(){d.current&&d.current.click()},children:t}),(0,i.jsx)("button",{className:"closeButton ".concat(Y.TF),onClick:function(){a&&a(),d.current&&(d.current.value=null)},style:{display:l?"block":"none"},children:"x"})]})});const te=ne;function oe(e){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):null}catch(n){return console.error("Error getting item ".concat(e," from localStorage"),n),null}}function re(e,n){try{window.localStorage.setItem(e,JSON.stringify(n))}catch(n){console.error("Error setting item ".concat(e," in localStorage"),n)}}function ae(e){try{window.localStorage.setItem("tricklens-frame-data",JSON.stringify(e,function(e,n){return n instanceof Uint8Array?Array.from(n):n}))}catch(e){console.warn("Failed to save frame to localStorage",e)}}ne.displayName="FileLoader",ne.propTypes={text:c.string.isRequired,onChange:c.func.isRequired,onRemove:c.func,showRemove:c.bool,accept:c.string},ne.defaultProps={onRemove:null,showRemove:!1,accept:""};var ie=t(971),le={};function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function se(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return ue(s,"_invoke",function(t,o,r){var a,l,c,s=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return a=n,l=0,c=e,f.n=t,i}};function p(t,o){for(l=t,c=o,n=0;!d&&s&&!r&&n<u.length;n++){var r,a=u[n],p=f.p,m=a[2];t>3?(r=m===o)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=t<2&&p<a[1])?(l=0,f.v=o,f.n=a[1]):p<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,f.n=m,l=0))}if(r||t>1)return i;throw d=!0,o}return function(r,u,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),l=u,c=m;(n=l<2?e:c)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,a){if(l||(r="next"),n=a[r]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,l<2&&(l=0)}else 1===l&&(n=a.return)&&n.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),l=1);a=e}else if((n=(d=f.n<0)?c:t.call(o,f))!==i)break}catch(n){a=e,l=1,c=n}finally{s=1}}return{value:n,done:d}}}(t,r,a),!0),s}var i={};function l(){}function c(){}function s(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(ue(n={},o,function(){return this}),n),d=s.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ue(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,ue(d,"constructor",s),ue(s,"constructor",c),c.displayName="GeneratorFunction",ue(s,r,"GeneratorFunction"),ue(d),ue(d,r,"Generator"),ue(d,o,function(){return this}),ue(d,"toString",function(){return"[object Generator]"}),(se=function(){return{w:a,m:f}})()}function ue(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ue=function(e,n,t,o){function a(n,t){ue(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},ue(e,n,t,o)}function de(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function fe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?de(Object(t),!0).forEach(function(n){pe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function pe(e,n,t){return(n=function(e){var n=function(e){if("object"!=ce(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=ce(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ce(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function me(e,n,t,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(o,r)}le.styleTagTransform=x(),le.setAttributes=b(),le.insert=m().bind(null,"head"),le.domAPI=f(),le.insertStyleElement=v(),u()(ie.Ay,le),ie.Ay&&ie.Ay.locals&&ie.Ay.locals;var he=(0,o.forwardRef)(function(e,n){var t=e.palette,o=e.setPalette,r=e.setSaveData,a=e.setFrame,l=e.setIsSettingsOpen,c=e.isSettingsOpen,s=e.saveData,u=e.frame,d=e.color,f=e.count,p=function(){var e,n=(e=se().m(function e(n){var t,o,r,i;return se().w(function(e){for(;;)switch(e.n){case 0:return t=n.data,o=n.name,e.n=1,k(t);case 1:r=e.v,i=fe(fe({},r),{},{name:o}),a(i),ae(i);case 2:return e.a(2)}},e)}),function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){me(a,o,r,i,l,"next",e)}function l(e){me(a,o,r,i,l,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"".concat(ie.KE," color").concat(d),children:[f>0?(0,i.jsx)("div",{className:ie.XJ,children:f}):null,(0,i.jsx)("div",{className:ie.jI,children:(0,i.jsx)(te,{text:"Select .sav …",onChange:function(e){var n=e.data,t=(0,_.n1)(n);r(t);try{localStorage.setItem("tricklens-save-data",JSON.stringify(t,function(e,n){return n instanceof Uint8Array?Array.from(n):n}))}catch(e){console.warn("Failed to save to localStorage",e)}window.scrollTo(0,0)},onRemove:function(){r(null),localStorage.removeItem("tricklens-save-data")},showRemove:!!s,accept:".sav",ref:n})}),(0,i.jsx)("div",{className:ie.jI,children:(0,i.jsx)(te,{text:"Select frame …",onChange:p,onRemove:function(){a(null),window.localStorage.removeItem("tricklens-frame-data")},showRemove:!!u,accept:".png"})}),(0,i.jsx)("div",{className:ie.jI,children:(0,i.jsx)($,{selectedPalette:t,onPaletteChange:o})}),(0,i.jsx)("div",{className:ie.oX,children:(0,i.jsx)("button",{className:"imgButton",onClick:function(){return l(!c)},children:"⛭"})}),(0,i.jsx)("span",{className:"".concat(ie.wm," fontBold"),children:"TrickLens Studio"})]})})});const be=he;he.displayName="ToolBar",he.propTypes={palette:c.string.isRequired,setPalette:c.func.isRequired,setSaveData:c.func.isRequired,setFrame:c.func.isRequired,setScaleFactor:c.func.isRequired,setIsSettingsOpen:c.func.isRequired,isSettingsOpen:c.bool.isRequired,saveData:c.object,frame:c.object,scaleFactor:c.number.isRequired,color:c.string.isRequired,count:c.number.isRequired};var ge=t(656),ve={};ve.styleTagTransform=x(),ve.setAttributes=b(),ve.insert=m().bind(null,"head"),ve.domAPI=f(),ve.insertStyleElement=v(),u()(ge.Ay,ve),ge.Ay&&ge.Ay.locals&&ge.Ay.locals;var ye=function(e){var n=e.settings,t=e.onSettingChange;return(0,i.jsxs)("div",{className:ge.W0,children:[(0,i.jsxs)("label",{children:["Photo scale:"," ",(0,i.jsxs)("select",{className:"select",name:"scaleFactor",value:n.scaleFactor,onChange:t,children:[(0,i.jsx)("option",{value:1,children:"1"}),(0,i.jsx)("option",{value:2,children:"2"}),(0,i.jsx)("option",{value:3,children:"3"}),(0,i.jsx)("option",{value:4,children:"4"})]})]}),(0,i.jsxs)("label",{children:["UI color:"," ",(0,i.jsxs)("select",{className:"select",name:"color",value:n.color,onChange:t,children:[(0,i.jsx)("option",{children:"red"}),(0,i.jsx)("option",{children:"green"}),(0,i.jsx)("option",{children:"yellow"}),(0,i.jsx)("option",{children:"blue"})]})]}),(0,i.jsxs)("label",{children:["Theme:"," ",(0,i.jsxs)("select",{className:"select",name:"theme",value:n.theme,onChange:t,children:[(0,i.jsx)("option",{value:"system",children:"System"}),(0,i.jsx)("option",{value:"light",children:"Light"}),(0,i.jsx)("option",{value:"dark",children:"Dark"})]})]}),(0,i.jsxs)("label",{children:["Export format:"," ",(0,i.jsxs)("select",{className:"select",name:"exportFormat",value:n.exportFormat,onChange:t,children:[(0,i.jsx)("option",{value:"png",children:"PNG"}),(0,i.jsx)("option",{value:"jpg",children:"JPG"})]})]}),"jpg"===n.exportFormat?(0,i.jsxs)("label",{children:["Quality:"," ",(0,i.jsxs)("span",{className:ge.Tm,children:[Math.round(100*n.exportQuality),"%"]}),(0,i.jsx)("input",{className:ge.pR,type:"range",name:"exportQuality",min:"0.1",max:"1",step:"0.1",value:n.exportQuality,onChange:t})]}):null,(0,i.jsxs)("label",{className:"pixel-checkbox",children:[(0,i.jsx)("input",{type:"checkbox",name:"isReversed",checked:n.isReversed,onChange:t}),(0,i.jsx)("span",{}),"Reverse order"]}),(0,i.jsxs)("label",{className:"pixel-checkbox",children:[(0,i.jsx)("input",{type:"checkbox",name:"isShowDeleted",checked:n.isShowDeleted,onChange:t}),(0,i.jsx)("span",{}),"Show deleted"]})]})};const xe=ye;ye.propTypes={settings:c.shape({isShowDeleted:c.bool.isRequired,scaleFactor:c.number.isRequired,color:c.string.isRequired,isReversed:c.bool.isRequired,exportFormat:c.string,exportQuality:c.number,theme:c.string}).isRequired,onSettingChange:c.func.isRequired};var je=t(713),we={};function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Se(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function Oe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Se(Object(t),!0).forEach(function(n){Pe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Se(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Pe(e,n,t){return(n=function(e){var n=function(e){if("object"!=_e(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=_e(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_e(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ke(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,a,i,l=[],c=!0,s=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=a.call(t)).done)&&(l.push(o.value),l.length!==n);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(e,n)||Te(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(e,n){if(e){if("string"==typeof e)return Ce(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ce(e,n):void 0}}function Ce(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ee(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function Fe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ee(Object(t),!0).forEach(function(n){De(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ee(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function De(e,n,t){return(n=function(e){var n=function(e){if("object"!=Ae(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=Ae(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ae(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ie(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,a,i,l=[],c=!0,s=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=a.call(t)).done)&&(l.push(o.value),l.length!==n);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return Ne(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ne(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}we.styleTagTransform=x(),we.setAttributes=b(),we.insert=m().bind(null,"head"),we.domAPI=f(),we.insertStyleElement=v(),u()(je.Ay,we),je.Ay&&je.Ay.locals&&je.Ay.locals;var Re=function(e){var n=e.editImage,t=e.palette,r=e.frame,a=e.exportFormat,l=e.exportQuality,c=e.username,s=Ie((0,o.useState)("none"),2),u=s[0],d=s[1],f=Ie((0,o.useState)(0),2),p=f[0],m=f[1],h=Ie((0,o.useState)(1),2),b=h[0],g=h[1],v=Ie((0,o.useState)("none"),2),y=v[0],x=v[1],j=Ie((0,o.useState)("normal"),2),w=j[0],S=j[1],O=Ie((0,o.useState)(0),2),P=O[0],k=O[1],T=Ie((0,o.useState)(0),2),C=T[0],E=T[1];(0,o.useEffect)(function(){k(0),E(0)},[n]);var F=function(e,n,t,r){var a=ke((0,o.useState)(e),2),i=a[0],l=a[1],c=ke((0,o.useState)(!1),2),s=c[0],u=c[1],d=(0,o.useCallback)(function(e){var o,a=e.currentTarget;if(a&&i){for(var c=a.getBoundingClientRect(),s=a.width/c.width,u=a.height/c.height,d=function(e){return e.touches&&e.touches.length>0?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY}}(e),f=d.x,p=d.y,m=(f-c.left)*s,h=(p-c.top)*u,b=A(n),g=Math.floor(m/8-b.left),v=Math.floor(h/8-b.top),y=function(e){if(Array.isArray(e))return Ce(e)}(o=i.photoData)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||Te(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),x=Number(r),j=0;j<x;j++)for(var w=0;w<x;w++){var _=g+j,S=v+w;_>=0&&_<128&&S>=0&&S<112&&(y[128*S+_]=Number(t))}l(Oe(Oe({},i),{},{photoData:y}))}},[i,n,r,t]),f=(0,o.useCallback)(function(e){e.cancelable&&e.preventDefault(),u(!0),d(e)},[d]),p=(0,o.useCallback)(function(e){e.cancelable&&e.preventDefault(),s&&d(e)},[s,d]),m=(0,o.useCallback)(function(e){e.cancelable&&e.preventDefault(),u(!1)},[]);return{editedImage:i,setEditedImage:l,drawHandlers:{onDrawStart:f,onDrawMove:p,onDrawEnd:m,onMouseLeave:m}}}(n?n[0]:null,r,p,b),D=F.editedImage,I=F.setEditedImage,N=F.drawHandlers,R="rgb"===y;!function(e,n,t,r,a){(0,o.useEffect)(function(){if(e){var o=(null==e?void 0:e.length)>1&&"none"!==r;if(n&&t&&"none"!==t||o){var i=o?(0,_.ah)(e.map(function(e){return e.photoData}),r):e[0].photoData;i=(0,_.Cf)(i,t),a(Fe(Fe({},e[0]),{},{photoData:i}))}"none"!==t||o||a(e[0])}},[t,e,r,a])}(n||null,D,u,R?"none":y,I);var M=function(e){if(!e||e<=0)return[];var n=["none","vertical","horizontal","quadrant","horizontal-2/3","border"];return e>2&&n.push("horizontal-bars"),e>3&&n.push("four-quadrant"),n}(null==n?void 0:n.length).map(function(e){return(0,i.jsx)("option",{value:e,children:e},e)});return(0,i.jsxs)("div",{className:je.sH,children:[(0,i.jsx)("div",{className:je.jW,children:(0,i.jsx)(X,{image:D,imageG:R&&(null==n?void 0:n.length)>=1?n[1]:void 0,imageB:R&&(null==n?void 0:n.length)>=2?n[2]:void 0,paletteId:t,frame:r,scaleFactor:4,isScale:!0,drawHandlers:N,paletteOrder:w,exportFormat:a,exportQuality:l,showShareButton:!0,username:c,rgbBrightness:P,rgbContrast:C})}),(0,i.jsxs)("div",{className:je.ne,children:[(0,i.jsxs)("label",{children:["Trick Lenses:",(0,i.jsxs)("select",{className:je.Lt,value:u,onChange:function(e){return d(e.target.value)},children:[(0,i.jsx)("option",{value:"none",children:"none"}),(0,i.jsx)("option",{value:"mirror-rtl",children:"mirror-rtl"}),(0,i.jsx)("option",{value:"mirror-ltr",children:"mirror-ltr"}),(0,i.jsx)("option",{value:"mirror-btt",children:"mirror-btt"}),(0,i.jsx)("option",{value:"mirror-ttb",children:"mirror-ttb"}),(0,i.jsx)("option",{value:"zoom",children:"zoom"}),(0,i.jsx)("option",{value:"zoom-h",children:"zoom-h"}),(0,i.jsx)("option",{value:"zoom-v",children:"zoom-v"}),(0,i.jsx)("option",{value:"tile",children:"tile"})]})]}),(0,i.jsxs)("label",{children:["Palette Order:",(0,i.jsxs)("select",{className:je.Lt,value:w,onChange:function(e){return S(e.target.value)},children:[(0,i.jsx)("option",{value:"normal",children:"normal"}),(0,i.jsx)("option",{value:"i",children:"invert"}),(0,i.jsx)("option",{value:"pa",children:"a"}),(0,i.jsx)("option",{value:"pb",children:"b"}),(0,i.jsx)("option",{value:"pc",children:"c"}),(0,i.jsx)("option",{value:"pd",children:"d"})]})]}),(0,i.jsxs)("label",{children:["Color:",(0,i.jsxs)("select",{className:je.Lt,value:p,onChange:function(e){return m(e.target.value)},children:[(0,i.jsx)("option",{value:"0",children:"Lightest"}),(0,i.jsx)("option",{value:"1",children:"Light"}),(0,i.jsx)("option",{value:"2",children:"Dark"}),(0,i.jsx)("option",{value:"3",children:"Darkest"})]})]}),(0,i.jsxs)("label",{children:["Brush Size:",(0,i.jsxs)("select",{className:je.Lt,value:b,onChange:function(e){return g(e.target.value)},children:[(0,i.jsx)("option",{value:"1",children:"1"}),(0,i.jsx)("option",{value:"2",children:"2"}),(0,i.jsx)("option",{value:"3",children:"3"}),(0,i.jsx)("option",{value:"4",children:"4"}),(0,i.jsx)("option",{value:"5",children:"5"}),(0,i.jsx)("option",{value:"6",children:"6"})]})]}),(null==n?void 0:n.length)>1?(0,i.jsxs)("label",{children:["Montage:",(0,i.jsxs)("select",{className:je.Lt,value:y,onChange:function(e){return x(e.target.value)},children:[M,n.length>2?(0,i.jsx)("option",{value:"rgb",children:"rgb"}):null]})]}):null,(null==n?void 0:n.length)>2&&R?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("label",{children:["Brightness: ",Math.round(20*P),(0,i.jsx)("input",{className:je.aw,type:"range",min:"-0.5",max:"0.5",step:"0.05",value:P,onChange:function(e){return k(e.target.value)}})]}),(0,i.jsxs)("label",{children:["Contrast: ",Math.round(10*C),(0,i.jsx)("input",{className:je.aw,type:"range",min:"-1",max:"1",step:"0.1",value:C,onChange:function(e){return E(e.target.value)}})]})]}):null]})]})};const Me=Re;Re.propTypes={editImage:c.object,palette:c.string,frame:c.object,exportFormat:c.string,exportQuality:c.number,username:c.string};var Be=t(158),Ge={};Ge.styleTagTransform=x(),Ge.setAttributes=b(),Ge.insert=m().bind(null,"head"),Ge.domAPI=f(),Ge.insertStyleElement=v(),u()(Be.A,Ge),Be.A&&Be.A.locals&&Be.A.locals;var Le=function(e){var n=e.image,t=e.paletteId,o=e.scaleFactor,r=I(n,null,null,t,null,void 0===o?.2:o).displayCanvasRef;return n?(0,i.jsx)("canvas",{ref:r}):null};Le.propTypes={image:c.object.isRequired,paletteId:c.string,scaleFactor:c.number};const qe=Le;var ze=function(e){var n=e.montagePhotos,t=e.palette,o=e.onClick;return 0===n.length?null:(0,i.jsx)("div",{className:Be.P,children:(0,i.jsx)("button",{onClick:o,children:n.map(function(e,n){return(0,i.jsx)(qe,{paletteId:t,image:e},n)})})})};ze.propTypes={montagePhotos:c.array.isRequired,palette:c.string,onClick:c.func};const Xe=ze;function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function Ue(e){return function(e){if(Array.isArray(e))return Ze(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function We(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Je(Object(t),!0).forEach(function(n){Ve(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Je(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ve(e,n,t){return(n=function(e){var n=function(e){if("object"!=Qe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=Qe(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qe(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function He(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,a,i,l=[],c=!0,s=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=a.call(t)).done)&&(l.push(o.value),l.length!==n);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(e,n)||Ke(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,n){if(e){if("string"==typeof e)return Ze(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ze(e,n):void 0}}function Ze(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}const $e=function(){var e=He((0,o.useState)(function(){return function(){try{var e=window.localStorage.getItem("tricklens-save-data");if(e){var n=JSON.parse(e);return n.images&&n.images.forEach(function(e){if(e&&e.photoData){var n=Array.isArray(e.photoData)?e.photoData:Object.values(e.photoData);e.photoData=new Uint8Array(n)}}),n}return null}catch(e){return console.warn("Failed to load save data from localStorage",e),null}}()}),2),n=e[0],t=e[1],r=He((0,o.useState)(function(){return function(){try{var e=window.localStorage.getItem("tricklens-frame-data");if(e){var n=JSON.parse(e);if(n.data){var t=Array.isArray(n.data)?n.data:Object.values(n.data);n.data=new Uint8Array(t)}return n}return null}catch(e){return console.warn("Failed to load frame data from localStorage",e),null}}()}),2),a=r[0],l=r[1],c=He((0,o.useState)(oe("palette")||"sgb2h"),2),s=c[0],u=c[1],d=He((0,o.useState)("Select a .sav file"),2),f=d[0],p=d[1],m=He((0,o.useState)(!1),2),h=m[0],b=m[1],g=He((0,o.useState)([]),2),v=g[0],y=g[1],x=He((0,o.useState)(function(){var e=oe("isReversed");return{scaleFactor:oe("scaleFactor")||2,isShowDeleted:oe("isShowDeleted")||!1,color:oe("color")||"green",isReversed:null===e||e,exportFormat:oe("exportFormat")||"png",exportQuality:Number(oe("exportQuality"))||.9,theme:oe("theme")||"system"}}),2),j=x[0],w=x[1],_=He((0,o.useState)([]),2),S=_[0],O=_[1],P=(0,o.useRef)(null),k=function(e){var n=e.target,t=n.name,o=n.value,r=n.type,a=n.checked,i="checkbox"===r?a:"scaleFactor"===t||"exportQuality"===t?Number(o):o;w(function(e){return We(We({},e),{},Ve({},t,i))})};(0,o.useEffect)(function(){O([])},[n]),(0,o.useEffect)(function(){re("palette",s),re("scaleFactor",j.scaleFactor),re("isShowDeleted",j.isShowDeleted),re("color",j.color),re("isReversed",j.isReversed),re("exportFormat",j.exportFormat),re("exportQuality",j.exportQuality),re("theme",j.theme)},[s,j]),(0,o.useEffect)(function(){var e=function(e){var n=e.ctrlKey||e.metaKey;"+"!==e.key&&"="!==e.key||!n?"-"===e.key&&n&&(e.preventDefault(),k({target:{name:"scaleFactor",value:Math.max(j.scaleFactor-1,1)}})):(e.preventDefault(),k({target:{name:"scaleFactor",value:Math.min(j.scaleFactor+1,4)}}))};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}},[]),(0,o.useEffect)(function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var n=j.theme;"system"===n&&(n=e.matches?"dark":"light"),document.body.setAttribute("data-theme",n)};n();var t=function(){"system"===j.theme&&n()};return e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}},[j.theme]),(0,o.useEffect)(function(){n?(p(""),n.images&&n.images.some(function(e){return e&&(!e.isDeleted||j.isShowDeleted)})||p("No images found")):p("Select a .sav file")},[n,j.isShowDeleted]);var T=function(e,t){if(t){if(S.length<4){var o=n.images[e];O(function(e){return[].concat(Ue(e),[o])})}}else O(function(n){return n.filter(function(n){return n.index!==e})})},C=S.length>=4,A=Array.from({length:30},function(e,t){var o=null==n?void 0:n.images[t];return!o||o.isDeleted&&!j.isShowDeleted?null:(o.index=t,o)}).filter(Boolean);A.sort(function(e,n){return e.photoIndex-n.photoIndex});var E=A.filter(function(e){return!e.isDeleted}),F=A.filter(function(e){return e.isDeleted});j.isReversed&&(E.reverse(),F.reverse());var D=[].concat(Ue(E),Ue(F));return(0,i.jsxs)(i.Fragment,{children:[n?(0,i.jsxs)("div",{className:"photoGrid scale".concat(j.scaleFactor),style:{gridTemplateColumns:"repeat(auto-fit, minmax("+160*j.scaleFactor+"px, 1fr))"},children:[D.map(function(e){var t=S.some(function(n){return n.index===e.index});return(0,i.jsx)(X,{image:e,paletteId:s,frame:a,scaleFactor:j.scaleFactor,showDeletedFlag:!0,onClick:function(){return y([e])},onSelect:T,isSelected:t,isDisabled:!t&&C,username:n.username,exportFormat:j.exportFormat,exportQuality:j.exportQuality},e.index)}),(0,i.jsx)("div",{style:{clear:"both"}})]}):null,f?(0,i.jsx)("div",{className:"mainMessage",onClick:function(){P.current&&P.current.click()},style:{cursor:"pointer"},children:f}):null,(0,i.jsx)(H,{isOpen:v.length>0,setIsOpen:y,title:"Magic",type:"full",children:(0,i.jsx)(Me,{editImage:v,palette:s,frame:a,exportFormat:j.exportFormat,exportQuality:j.exportQuality,username:n?n.username:""})}),(0,i.jsx)(H,{isOpen:h,setIsOpen:b,title:"Settings",type:"small",children:(0,i.jsx)(xe,{settings:j,onSettingChange:k})}),(0,i.jsx)(Xe,{montagePhotos:S,palette:s,onClick:function(){return y(S)}}),(0,i.jsx)(be,{palette:s,setPalette:u,saveData:n,setSaveData:t,frame:a,setFrame:l,setIsSettingsOpen:b,isSettingsOpen:h,color:j.color,count:D.length,ref:P})]})};var Ye=t(171),en={};function nn(){return(0,i.jsx)(a.I9,{children:(0,i.jsx)(a.BV,{children:(0,i.jsxs)(a.qh,{path:"/",element:(0,i.jsx)(l,{}),children:[(0,i.jsx)(a.qh,{index:!0,element:(0,i.jsx)($e,{})}),(0,i.jsx)(a.qh,{path:"*",element:(0,i.jsx)($e,{})})]})})})}en.styleTagTransform=x(),en.setAttributes=b(),en.insert=m().bind(null,"head"),en.domAPI=f(),en.insertStyleElement=v(),u()(Ye.A,en),Ye.A&&Ye.A.locals&&Ye.A.locals;var tn=document.getElementById("root");r.createRoot(tn).render((0,i.jsx)(nn,{}))}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var t=r[e]={id:e,exports:{}};return o[e](t,t.exports,a),t.exports}a.m=o,e=[],a.O=(n,t,o,r)=>{if(!t){var i=1/0;for(u=0;u<e.length;u++){for(var[t,o,r]=e[u],l=!0,c=0;c<t.length;c++)(!1&r||i>=r)&&Object.keys(a.O).every(e=>a.O[e](t[c]))?t.splice(c--,1):(l=!1,r<i&&(i=r));if(l){e.splice(u--,1);var s=o();void 0!==s&&(n=s)}}return n}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,o,r]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var r=Object.create(null);a.r(r);var i={};n=n||[null,t({}),t([]),t(t)];for(var l=2&o&&e;("object"==typeof l||"function"==typeof l)&&!~n.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(n=>i[n]=()=>e[n]);return i.default=()=>e,a.d(r,i),r},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var n=a.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var o=t.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=t[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{a.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={792:0};a.O.j=n=>0===e[n];var n=(n,t)=>{var o,r,[i,l,c]=t,s=0;if(i.some(n=>0!==e[n])){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(c)var u=c(a)}for(n&&n(t);s<i.length;s++)r=i[s],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},t=self.webpackChunktricklens_studio=self.webpackChunktricklens_studio||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),a.nc=void 0;var i=a.O(void 0,[268],()=>a(43));i=a.O(i)})();